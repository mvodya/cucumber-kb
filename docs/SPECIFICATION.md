# Спецификация стандарта CUKB

## Модель

![Model Spec](images/model_spec.drawio.svg)

Модель имеет следующие параметры:

| Название | Описание                                      |
| -------- | --------------------------------------------- |
| meta     | Заголовок с описанием о чем вообще эта модель |
| schema   | Перечисление параметров                       |

Параметр meta имеет следующие параметры:

| Название      | Описание                                 |
| ------------- | ---------------------------------------- |
| name          | Название для описания модели             |
| description   | Описание модели                          |
| schemaVersion | Версия, должна соответствовать версии БЗ |

Параметр schema имеет следующие параметры:

| Название    | Описание                                                                  | Обязательный? |
| ----------- | ------------------------------------------------------------------------- | ------------- |
| param       | Идентификатор параметра (его название, которое будет использоваться в БЗ) | Да ✅          |
| title       | Отображаемое название параметра                                           | Да ✅          |
| description | Пояснение к параметру                                                     | Нет ❌         |
| unit        | Единица измерения параметра (просто текст, для отображения постфиксом)    | Нет ❌         |
| spec        | Описание типа и формата параметра                                         | Да ✅          |
| require     | Обязательное требование заполнения данного параметра пользователем        | Да ✅          |

Параметр spec имеет следующие параметры:

| Название | Описание   |
| -------- | ---------- |
| type     | Тип данных |

Параметр spec types имеет следующие параметры:

| Тип данных | Описание типа             | Название параметра | Описание параметра               | Обязательный? |
| ---------- | ------------------------- | ------------------ | -------------------------------- | ------------- |
| int        | Целочисленное число       | min                | Минимальное допустимое значение  | Нет ❌         |
|            |                           | max                | Максимальное допустимое значение | Нет ❌         |
| float      | Число с плавающей запятой | min                | Минимальное допустимое значение  | Нет ❌         |
|            |                           | max                | Максимальное допустимое значение | Нет ❌         |
| enum       | Перечисления для выбора   | data               | Массив выбираемых данных         | Да ✅          |

Параметр spec enum data имеет следующие параметры:

| Название    | Описание                                                            | Обязательный? |
| ----------- | ------------------------------------------------------------------- | ------------- |
| title       | Отображаемое название выбираемой опции                              | Да ✅          |
| description | Пояснение и описание к выбираемой опции                             | Нет ❌         |
| image       | Изображение (или список изображений) для пояснения выбираемой опции | Нет ❌         |
| value       | Идентификатор, используемый в БЗ                                    | Да ✅          |

## База знаний

![Model Spec](images/data_spec.drawio.svg)

База знаний имеет следующие параметры:

| Название | Описание                                               |
| -------- | ------------------------------------------------------ |
| meta     | Заголовок с описанием о чем вообще эта база знаний     |
| stack    | Перечисление параметров на выходе у данной базы знаний |
| graph    | Начало дерева базы знаний                              |

Параметр meta имеет следующие параметры:

| Название      | Описание                                     |
| ------------- | -------------------------------------------- |
| name          | Название для описания базы знаний            |
| description   | Описание базы знаний                         |
| schemaVersion | Версия, должна соответствовать версии модели |

Параметр stack имеет следующие параметры:

| Название    | Описание                          | Обязательный? |
| ----------- | --------------------------------- | ------------- |
| id          | Название для описания базы знаний | Да ✅          |
| title       | Заголовок вывода                  | Да ✅          |
| description | Подробное описание вывода         | Да ✅          |
| limit       | Ограничение на вывод              | Нет ❌         |

Параметр graph - это массив объектов. Поля объекта, который содержит graph:

| Название   | Описание                      | Обязательный? |
| ---------- | ----------------------------- | ------------- |
| type       | Тип выполняемого действия     | Да ✅          |
| statements | Условия для данного ветки     | Нет ❌         |
| graph      | Ветка дерева                  | Нет ❌         |
| stack      | Тип вывода                    | Нет ❌         |
| report     | Заполнение вывода             | Нет ❌         |
| comment    | Комментарий для текущей ветки | Нет ❌         |

Параметр statements имеет следующие параметры:

| Название  | Описание                                           | Обязательный? |
| --------- | -------------------------------------------------- | ------------- |
| type      | Тип выполняемого действия                          | Да ✅          |
| param     | Параметр для ветвления, который будет сравниваться | Да ✅          |
| predicate | Способ сравнения                                   | Да ✅          |
| value     | Значение, с которым сравнивается входные данные    | Да ✅          |
| require   | Обязательность параметра                           | Да ✅          |
| score     | Важность условия                                   | Нет ❌         |

У типа report в параметре report следующие параметры:

| Название     | Описание                         | Обязательный? |
| ------------ | -------------------------------- | ------------- |
| title        | Заголовок вывода                 | Да ✅          |
| description  | Подробное описание вывода        | Да ✅          |
| requireScore | Минимальная необходимая важность | Нет ❌         |

В graph могут быть узлы, содержащие graph.

Пример

```json
{
    "graph":[
        {
            "type": "...",
            "statements": [],
            "graph":[
                {...}
            ]
        },
        {...}
    ]
}
```

## Запрос

Запрос состоит из трех частей
- модель (model)
- база знаний (data)
- входные переменные (object)

Пример

```json
{
    "model": {...},
    "data": {...},
    "object": {
        "input": "my value",
        "other_input": true,
        "int_input": 123,
        ...
    }
}
```

Входные данные подаются в соответствии с моделью, передаваемой решателю.
